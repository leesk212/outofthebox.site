---
tags: malware cryptojacking 🌟paper-review
toc: True
---
# Introduction

## Crpytojacking 동향
* 암호화폐 시장이 커지면서 암호화폐와 관련된 보안 위협이 증가하고 있습니다.
* 특히 Coinhive 또는 Monero에 의해서 즉시 사용가능한 (ready-to-use) 채굴 script를 통해서 cryptojacking malware는 공격자들을 위한 없어서 안될 도구가 되었다.
* 실제로 bank, military servers, online-video sharing platforms, gaming platform등은 cryptojacking malware의 가장 큰 피해자중 하나이다.
* 현재까지 이들을 방어하기 위해서, 1. blacklist방법으로부터 사용자를 방어하는 browser exetensiun 과 다른 분석 방식의 백신 프로그램은 단지 부분적인 "만병통치약"일뿐 공격자들은 난독화기술을 사용하여 쉽게 우회하거나 또는 그들의 도메인의 script를 바꿔서 공격을 진행한다.
* 그래서 추가적인 systematic인 cryptojacking연구가 필요하다.
* 투자자는 또한 직접 채굴 풀을 구축하여 새로운 코인을 생성하여 이익을 얻을 수 있다.
* 채굴 작업의 수익성은 공격자들이 빠르게 출현하는 생태계로 끌어들였다.

## Cryptojacking의 정의
* Cryptojacking은 암호화폐 채굴 동의 없이 피해자의 연산 능력을 이용하는 행위이다.
* 비권한된 mining 연산은 추가적인 전력 소비를 지불하게 하고, victim host 컴퓨터의 연산 효율을 매우 감소시킨다.
* 결과적으로 공격자는 비권한된 컴퓨터 파워를 cryptocurrency(암호화폐)로 변환시킨다.
* 이런 목적으로 사용된 mlaware를 *cryptojacking*이라 부른다.
* 특히 즉시 사용가능한 browser mining script 구현의 제공하는 Coinhive, CryptoLoot같은 service provider의 출현 이후에, 공격자들은 쉽게 인기있는 website를 통해 많은 수의 사용자들에게 접근할 수 있었다.

### Crpytojacking의 첫번째 예시: In-browser cryptojacking
* Cryptojacking은 Youtue내에 Google의 advertisement packages와 병합된다.
* victim의 host에 의해서 compile된 감연된 광고 package는 victime이 관련된 페이지에 있는한 비권한된 채굴을 수행한다. 
* Youtuge와 비슷한 media content 제공업체들은 공격자들에게 이상적이다. (상대적 신뢰도, 인기도, 그리고 이용자들의 평균 이용시간 때문에)
* 또 다른 사건에서 cryptojacking malware는 UK 정부에 의해서 제공된 plugin에서 발견되었다.
* 이때, 이 플러그인은 수천의 governmental page와 비 govermental-page에서 사용되었다.

### Cryptojacking의 두번째 예시: Critical servers.
* cryptojacking의 web-page에 내장되어있는 것 뿐만아니라, 또한 *well-protected govermental and milittary servers*에서 발견된다.
* 미 방어 정부는 bug-bounty challenge 동안, 그들의 서버에서 cryptojacking malware를 발견했다.
* Cryptojacking malware는 Coinhive 제공업체에서 유명한 서비스에 의해서 개발된, 그리고 이것의 존재동안 35.4 Monero coin에서 채굴된 DOD server들에서 발견되었다. 
* 비슷하게, 다른 정부 캐이스는 러시아 핵 개발 연구 센터로부터 발견되었다.
* 몇몇 이 연구실에서 일하고 있는 과학자들은 이 시설 server에서 암호화폐 채굴기를 업로드해서 잡혔다.
* 더 나아가서 공격자는 서비스 제공자가 제공하는 스크립트를 사용할 뿐만 아니라 악의적이지 않고 합법적인 오픈소스 크립토마이너를 수정했다.
* 예를들어 cyber security 회사는 이탈리아 은행의 기업 네트워크에서 잘 알려진 유럽 기반 봇넷으로의 불규칙한 데이터 전송을 탐지했다. 추가 조사를 통해 해당의 것이 Bitcoin miner임을 확인했다.

### Cryptojacking의 세번째 예시: 진보된 기술을 이용하는 것
* Attacker가 cryptojacking을 퍼트리는데 사용하는 *advanced techniques*들이 있다.
  * botnet, Vollgar <- attacked all MySQL Servers in the world 
  * Zoom video <- merged the main Zoom application and cryptojacking malware and published it via different file-sharing platforms
  * Steam & Nintendo Switch <- to embed and distribute crpytojacking malware
  * (in a recent study) firmware(Mikrotik) <- discoverd a firmware exploit in Mikrotik routers that were used to embed crpytomining code into every outgoing web connection, where 1.4 million MikroTik routers were exploited

### Crpytojacking Detection의 문제점
* 크립토재킹 맬웨어의 만연한 특성을 감안할 때 무단 채굴 작업이 사용자의 동의나 허가 없이 컴퓨팅 플랫폼의 컴퓨팅 리소스를 남용하는 것을 감지하고 방지하는 것이 중요합니다.
* 그러나 중요하지만 크립토재킹을 탐지하는 것은 여러 면에서 기존 멀웨어와 다르기 때문에 어렵습니다.
  * 1. 첫번째 그들은 목표는 victim의 computing power를 남용하는 것이다. ( 전통적인 malware의 경우에서 피해를 입히거나 조작하는 것 대신에), 전통적인 malware detection과 방어 시스템은 malware의 침해 행위를 탐지하는 것에 최적화 되어있지만 cryptojacking은 단지 컴퓨팅 ㅈ자원을 사용하고 그리고 attacker에게 계산된 hash값을 전달한다. 그래서 malware detection sytstem은 단순히 높은 퍼포먼스를필요하는 무건운 어플리케이션으로써 생각한다.
  * 2. 둘째, 합법적인 웹 사이트에 사용하거나 포함할 수도 있습니다. 이는 해당 웹 사이트가 종종 신뢰할 수 있고 사용자가 컴퓨터에서 동의 없이 채굴하는 것을 기대하지 않기 때문에 눈에 띄기 어렵게 만듭니다.
  * 3. 셋째, 전통적인 맬웨어 공격에서 공격자는 궁극적으로 민감한 정보를 빼내거나(예: APT(Advanced Persistent Threat)) 시스템을 사용할 수 없도록 하거나(즉, DDoS(분산 서비스 거부)) 제어할 수 있습니다. 크립토재킹 맬웨어 공격에서 피해자의 컴퓨터(예: Botnet)에서 공격자의 목표는 가능한 한 오랫동안 시스템에서 은밀하게 유지하는 것입니다. 공격 수익은 크립토재킹 멀웨어가 탐지되지 않는 시간에 정비례하기 때문입니다. 따라서 공격자는 필터링 및 난독화 기술을 사용하여 멀웨어를 탐지 시스템에서 더 어렵게 만들고 사용자가 알아차리기 어렵게 만듭니다.

## 해당 논문의 Contribution
* 기존의 연구는 Cryptojacking malware에 대한 탐지 또는 방지 메커니즘을 제안하거나, 크립토재킹 위협 환경을 분석하고있다.
* 그리고 문헌에는 서로 다른 크립토재킹 맬웨어 유형, 크립토재킹 맬웨어가 사용하는 기술 및 문헌의 크립토재킹 연구에 대한 검토를 모두 다루는 체계적인 연구가 부족합니다.
* 이 논문은 이런 문헌의 차이를 줄이기위해서 cryptojacking malware의 systematic overview를 제시한다. (42개의 cryptojacking 연구 논문ㄷ르의 조합으로부터 얻을  수 있는 정보에 기반하여서) (두개의 독립적인 dataset과 함께 26K개의 cryptojacking samples 들과) (그리고 45개의 major attacks instance와 함께)
* 주어진 널리퍼진 cryptojacking의 사용에 의해서, 실무적인 방어 솔루션을 방어를 가속화하기 위해서 security community crpytojacking malware의 systematize한 지식을 얻는 것은 이것은 중요하다 

### 해당 논문에 포함되어있는 추가적인 견해
* 최근 보안 보고서에서는 클라우드 서버, Docker 엔진, 대규모 Kubernetes 클러스터의 IoT 장치와 같은 보다 강력한 플랫폼을 대상으로 하는 크립토재킹 공격의 수가 증가하는 것을 발견했습니다. 크립토재킹 악성코드를 퍼뜨리기 위해 하이재킹 및 초기 액세스 를 얻기 위해 공격자는 다음을 활용합니다.
  * hardware vulnerabilites
  * recent CVEs
  * poorly configured IoT devices
  * Docker engines and Kubernetes clusters with poor security
  * popular DDoS botnets for the sied-profit.
  * 이 새로운 크립토재킹 악성코드 경향은 연구원들이 자세히 조사하지 않았습니다.
* 우리는 문헌에서 크립토재킹 탐지 메커니즘을 제안하는 연구에서 몇 가지 문제를 확인했습니다.
  * 첫째, 우리는 크립토마이닝 스크립트가 포함된 웹사이트가 자주 업데이트되기 때문에 제안된 탐지 연구에서 데이터 세트 날짜를 보고하는 것이 중요하다는 것을 발견했습니다. 이는 문헌 연구에서 흔하지 않습니다.
  * 둘째, 제안된 탐지가 대부분의 연구에서 누락된 온라인 또는 오프라인인지 보고하는 것이 중요합니다.
  * 셋째, 문헌의 연구에서는 제안된 솔루션의 사용자 측 오버헤드를 측정하지 않았으며, 이는 특히 브라우저 기반 솔루션에서 매우 중요합니다.
* 크립토마이닝이 게시자나 비영리 조직과 같은 합법적인 웹사이트 소유자를 위한 대체 자금 조달 메커니즘이 될 수 있지만 브라우저 내 크립토마이닝의 사용은 키워드 기반 자동 감지 시스템으로 인해 감소했습니다.
* 다른 조사:
  * 이러한 설문조사는 블록체인의 합의 프로토콜 및 채굴 전략, Bitcoin 및 블록체인 기술의 도전, 보안 및 개인 정보 보호 문제, IoT와 같은 다양한 산업에서의 블록체인 구현에만 초점을 맞춥니다.
  * [A Survey of Attack Instances of Cryptojacking Targeting Cloud Infrastructure](https://dl.acm.org/doi/abs/10.1145/3379310.3379323) 과 비슷하지만 해당 SOK 논문은 (두 큰 dataset의 관찰과 분석으로 만들어진)cryptojacking malware에 더욱 집중되어있다. 

# Background

## BlockChain
블록체인은 네트워크의 당사자가 수행하는 P2P(피어 투 피어) 거래를 변경할 수 없는 방식으로 저장하는 분산형 디지털 원장 기술입니다. 블록체인 구조는 블록 체인으로 구성됩니다. 예를 들어 비트코인[39]에서 각 블록은 블록 헤더와 트랜잭션의 두 부분으로 구성됩니다. 블록 헤더는 1) 이전 블록의 해시, 2) 버전, 3) 타임스탬프, 4) 난이도 목표, 5) 논스, 6) 머클 트리의 루트 정보로 구성됩니다. 이전 블록의 해시를 포함함으로써 모든 블록은 수학적으로 이전 블록에 바인딩됩니다. 이 바인딩을 사용하면 체인의 모든 블록에서 데이터를 변경할 수 없습니다. 반면, 각 블록의 두 번째 부분에는 개별적으로 확인된 트랜잭션 집합이 포함됩니다.

## Cryptocurrency Mining
* 블록체인의 불변성은 합의 메커니즘에 의해서 제공되어진다. 그리고 이것은 "Proof-of-Work" protocol에 의해서 일반적으로 말해진다.
* 각각의 block의 불변성과 그리고 전체 블록체인의 불변성은 block 구조의 chain 덕분에 보존된다.
* PoW에서 network에서의 몇몇 노드는 unique한 hash value를 찾기위해서 hash puizzle을 해결한다. 그리고 이것을 네트워크에 있는 모두 다른 노드에게로 broadcasting을 진행한다.
* valid hash value를 broadcasting한 첫번째 노드는 block reward에게 보상을 받고 그리고 transaction fee를(거래 수수료를) 수집한다. 
* A valid hash value는 다른 타겟에 따라서 검증되어진다. (만약 이것이 다른 타겟을 만족된다면, 이것은 모든 다른 노드들이 승낙해야하고 그리고 타당한 hash에서 찾은 노드는 보상받아진다.
* 다른 PoW 구현은 대게 다른 타겟에의해서 다른 방법을 갖고 있습니다.

### Cryptomining(jacking)의 공격자의 공격 동기(?) 
* Miner는 시행착오를 통해 모든 시도에 대한 nonce값을 증가시켜 유효한 hash 값을 찾으려고 한다.
* 유효한 hash값이 찾아지자마자, 전체적인 block은 넹트워크에 broadcast되고, 해당 block은 가장 마지막 블록의 끝에 추가되어진다.
* 이것은 잘 알려진 *cryptocurrency mining*의 과정이다 그리고 이것은 새로운 cryptocurrencies를 만들기위한 단지 하나의 방법이다.
* miner들에 의해서 valid hash value의 찾는것의 기회는 직접적으로 minor의 hash power와 관련이다. (그리고 이것은 hardware 기반된 연산능력과 관련있다.)
* 그러나 더 많은 하드웨어는 전력 소비를 증가시킨다.
* 따라서 공격자는 자신의 전력 소비를 늘리지 않고 계산 능력을 높일 수 있는 새로운 방법을 찾고자 하는 동기를 갖게 됩니다.

### Mining의 역사
* Bitcoin의 발명에 따라서, 만은 다른 대체코인 (altcoin들은) 합병되거나 또는 여전히 합병중이다. 이러한 새로운 암호화폐는 비트코인의 일부 문제(예: 확장성[40], 개인 정보 보호)를 해결하거나 새로운 애플리케이션(예: 스마트 계약[41])을 제공한다고 주장합니다.
* Bitcoin의 일찍의 개발에서 mining은 주로 CPU에서 이뤄졌고 사용자들은 쉽게 귿르의 일반적인 CPU를 Bitcoin Mining에 사용할 수 있었다.
* 시간이 흘러서 GPU 기반의 miner들은 충분히 CPU miner보다 더 많은 이득을 얻을 수 있었다. GPU들이 특히 무거운 applicaiton을 위한 높은 연산능력을 가졌기 때문이다.
* 후에 Field Programmable Gate Array(FPGA)는 암호화폐 체굴의 경향을 바꿨다. 그들은 hardware를 customized하고 그리고 충분한 이익을 제공하기 때문이다. (CPU, GPU 기반의 체굴보다) 
* 마지막으로, Mining에 기반되는 Application-Specific Integrated Circuit (ASIC)의 사용은 최근에 채굴 산업을 지배하고 이;ㅆ다. 그들은 특히 암호화폐 체굴을 위해서 특히 제작되고 구성될 수 있기 떄문이다.

### Block-chain의 다양한 hash_function의 사용, Monero의 해쉬 함수 사용의 진행
* alternative cryptocurrencies들은 또한 block-chain에서 다른 hash function을 사용했다. 그리고 이것은 채굴 과정에서 다양성을 이끌었다.
 * Monero는 CryptoNight algorithm을 hash function으로 사용한다. CryptoNight는 특히 CPU와 GPU Mining을 위해서 디자인되었다. 이것은 ASIC miner들을 막기위해서 L3 Cache를 사용한다.
 * RandomX algorithm의 사용과 함께 Monero blockchain은 완전히 ASIC miner들이 줄어들게 하였고 그리고, CPU의 특성을 최대로 사용할 수 있게하였다.
 * 이 특징은 Monero가 단지 주요한 암호화폐 CPU 마이닝의 선호도를 증가시키면서 platform이 되도록했다. 
 * 또한, 모네로는 사설 암호화폐로도 알려져 있으며, 믹서와 링 서명을 통해 추적 불가능 및 연결 불가능 기능을 제공합니다.
 * Monero의 ASIC 채굴 방지 특성과 개인 정보 보호 기능은 공격자에게 바람직합니다.

# SOK 방법론
## Paper
![image](https://user-images.githubusercontent.com/67637935/143972847-165880fd-730b-488c-ac64-ffd8b532df55.png)

* 1개의 논문은 Survey를 제외하면 나머지는 크게 두가지 ```Cryptojacking detection paprers(27)``` 와 ```Crpytojacking analysis paper(15)```를 확인할 수 있었다.
* 이것들을 잘 정리해서 Systematization하게 정리를 진행하였다.

## Samples
* 대부분의 cryptojacking 논문들은 하나의 Cryptojacking Malware의 측면에만 집중되어있지만 crryptojacking을 이해하기위해서는 우리는 실제 cryptojacking malware sample로부터 이점을 얻게 되었다.
* 이 목적을 위해서 우리는 2개의 데이터셋을 수집하였다. 
  1. VriusTotal (VT) Dataset: VT dataset은 20200개의 암호화폐 "miner" Sample과 VT 스캔 보고서로 구성된다.
  2. Public WWW Dataset: 그들의 source code에서 Crpytomining script를 포함하고 있는 6269의 독립적인 domain을 찾았다.
* 우리는 이 두 데이터셋을 해당되는 SECTION과 따르는 목적을 위해서 사용했다.
  1. in-browser 와 host-based cryptojacking의 lifecycle을 이해하기 위해서
  2. 다른 연구 및 크립토재킹 멀웨어의 출처로 제공된 서비스 제공자 목록을 확인하기 위해서
  3. 브라우저 내 크립토재킹 악성코드에 사용된 모바일 필터링 방법의 사용을 확인하기 위해서
  4. 모네로가 크립토재킹에 사용되는 주요 대상 통화인지 확인하기 위해서
  5. cryptojacking malware를 사용하는 다른 암호화폐를 찾기위해서
  6. 난독화를 위한 CPU 제한 기술의 존재를 확인하기 위해서
  7. 난독화를 위한 코드 인코딩 사용을 확인하고 이해하기 위해서 
* 하지만 해당되는 두 Dataset에도 limitation이 존재했다.
* VT 데이터 세트의 경우 Academic API 권한과 스캔 보고서를 사용하여 VT에 의해 437K 고유 샘플(크립토재킹 및 비크립토재킹)이 제공됩니다.
* 따라서 더 확장된 권한이 있는 API 액세스가 존재하기 때문에 VT 데이터 세트는 VT에 대한 완전한 크립토재킹 샘플 목록이 아닙니다.
* 예를 들어, VT 데이터 세트에 있는 모든 크립토재킹 샘플의 85%가 2018년의 것임을 관찰했으며, 이는 2018년 샘플이 VT 데이터 세트에서 과도하게 표현되었음을 보여줍니다.

![image](https://user-images.githubusercontent.com/67637935/143974704-00be9c81-cea0-4191-b780-6cbde3c23937.png)

* 따라서 실제 샘플의 표현 측면에서 결론은 편향이 있을 수 있습니다. 그러나 이러한 대규모 측정 연구는 이 작업의 범위를 벗어납니다.
* 예를 들어, [46]의 연구는 12년 동안 수집된 120만 명의 악성 암호화폐 채굴자를 대상으로 한 이러한 연구를 제시합니다. 
* 우리 논문에서 우리는 크립토재킹 멀웨어의 행동 특성을 이해하고 문헌의 연구를 검토하는 데 중점을 두었습니다.
* e 데이터 세트와 그 한계에 대한 자세한 설명을 제공하고 부록에서 이러한 데이터 세트의 분포 분석을 수행합니다. 
* 마지막으로 이 분야의 연구를 더욱 가속화하기 위해 데이터세트도 공개했습니다.

## Major Attack Instances
* 세 번째 정보 출처는 Kaspersky, Trend Micro, Palo Alto Network, IBM 등의 보안 회사에서 발표한 보안 보고서에 나타난 주요 공격 사례와 뉴스에 나온 주요 보안 사례입니다.
* 뉴스에 나온 주요 공격 사례는 독특하고 흥미로운 사례를 식별하는 데 사용될 수 있으며 보안 보고서는 보안 회사의 실시간 및 대규모 도달으로 인해 동향을 조명할 수 있습니다.
* 특히, 동기 부여 목적으로 섹션 1에서 이러한 인스턴스를 사용했습니다. 섹션 5에서 크립토재킹 맬웨어가 사용하는 다양한 기술을 알아보세요. 크립토재킹 악성코드 공격의 잠재적인 새로운 경향을 알아보기 위해 섹션 7에서.
* 이러한 리소스의 컬렉션은 다른 연구원에게 유용할 수 있고 여기의 공간 제한으로 인해 데이터 세트의 블랙리스트 및 서비스 제공자의 문서 링크와 함께 상세하고 조직적인 방식으로 공개합니다.
* 부록 A의 표 10은 이 백서에서 사용한 공격 인스턴스의 연간 분포를 보여줍니다.

# Cryptojacking의 유형
* 암호화폐 채굴 악성코드라고도 알려진 크립토재킹 악성코드는 사용자가 암호화폐를 채굴하고 보상을 받을 수 있는 권한 없이 피해자 기기(예: 컴퓨터, 모바일 기기)의 컴퓨팅 리소스를 손상시킵니다.
* Cryptojacking malware의 lifecycle은 3가지 단계로 구성된다.
  1. *script preparation*
  2. *scrpit injection*
  3. *the attack*
* script 준비와 공격 단계는 모든 cryptojacking malware type과 같다.
* 반면에, *script injection* 단계는 malicious script를 website에 삽입하거나, 또는 malware를 다른 application에 삽입하는 것에 따라 다르다.
* 이것에 기반하여 우리는 cryptojacking을 두가지 종류로 나누다.
  1. *In-browser crpytojacking* 
  2. *Host-based cryptojacking* 

## Type-1: In-browser Cryptojacking
![image](https://user-images.githubusercontent.com/67637935/143984994-417ef6fb-a374-4901-ae45-ac1d79e2d64a.png)

* JavaScript(JS) 및 WebAssembly(Wasm)와 같은 웹 기술의 발달로 대화형 웹 콘텐츠가 가능해지며, 이는 피해자 장치(예: 컴퓨터 또는 모바일 장치)의 여러 계산 리소스(예: CPU)에 액세스할 수 있습니다.
* 브라우저 내 크립토재킹 맬웨어는 이러한 웹 기술을 사용하여 피해자의 CPU에서 웹 페이지 상호 작용을 통해 암호 화폐 마이닝을 위해 피해자의 시스템에 무단으로 액세스합니다.
* 해당 그림은 in-browser cryptojacking malware에서 Script를 준비하고 inject하는 단계입니다.
  * (Step1) Script Owner는 첫번째로 registers(등록하고) 
  * (Step2) 서비스 제공자로부터 서비스 자격 증명과 바로 사용할 수 있는 마이닝 스크립트를 받습니다
  * (Step3) 서비스 제공자는 마이닝 작업을 사용자 간에 분리하고 나중에 마이닝 풀에서 모든 수익을 수집하여 사용자 간에 공유합니다. 서비스 자격 증명을 받은 스크립트 소유자는 악성 크립토재킹 스크립트를 웹사이트의 HTML 소스 코드에 삽입합니다.

![image](https://user-images.githubusercontent.com/67637935/143985471-e4c884dd-c8ef-4f36-ac4e-51354c7e8044.png)
* 공격단계에서는 Fig2처럼 진행된다.
  * (Step 1,2) victim은 첫번째로 그들의 기기로부터 이 website source code로 접근한다.
  * (Step 3) 웹 브라우저는 웹 사이트를 로드하고 자동으로 크립토재킹 마이닝 스크립트를 호출합니다.
  * (Step 4) 스크립트가 실행되면 서비스 제공자에게 마이닝 작업을 요청합니다.
  * (Step 5) 서비스 제공자는 작업 요청을 마이닝 풀로 전송합니다.
  * (Step 6) 그런 다음 마이닝 풀은 마이닝 작업을 할당합니다.
  * (Step 7) 서비스 제공자는 작업을 마이닝 스크립트에 반환합니다.
  * (Step 8) 마이닝 스크립트는 이 새로운 마이닝 할당을 피해자의 컴퓨터에 반환합니다.
  * (Step 9) 피해자의 장치가 마이닝 프로세스를 시작합니다. 마이닝 스크립트와 서비스 제공자가 온라인 상태를 유지하는 한 스크립트는 피해자의 컴퓨터에서 마이닝 프로세스를 계속합니다.
  * (Step 10) 그런 다음 마이닝 결과를 서비스 제공자에게 반환합니다.
  * (Step 11) 서비스 제공자는 다른 소스에서 모든 데이터를 수집하고 그 결과를 마이닝 풀로 보냅니다.
  * (Step 12) 마지막으로 마이닝 풀은 마이닝된 통화의 형태로 서비스 제공자에게 보상을 다시 보냅니다.
* 스크립트 소유자는 서비스 공급자가 서비스 요금을 인하한 후 서비스 자격 증명을 사용하여 서비스 공급자로부터 지분을 받습니다.
* 이 생태계에서 공격자는 피해자의 CPU 파워를 사용하며 피해자는 다른 주체로부터 어떠한 대가나 혜택도 받지 못합니다.

## Type-2: Host-based Cryptojacking
![image](https://user-images.githubusercontent.com/67637935/143990015-7ba1a1bf-8370-4a59-9ce7-4c5189afceac.png)

* 호스트 기반 크립토재킹은 공격자가 피해자 호스트의 리소스에 액세스하고 맬웨어 소유자를 위한 좀비 컴퓨터로 만들기 위해 사용하는 조용한 맬웨어입니다. 
* 브라우저 내 크립토재킹 멀웨어와 비교할 때 호스트 기반 멀웨어는 웹 스크립트를 통해 피해자의 연산 능력에 액세스하지 않습니다. 대신 호스트 시스템에 설치해야 합니다. 
* 따라서 이들은 일반적으로 취약성 또는 사회 공학 기술을 사용하여 타사 애플리케이션에 내장되거나 드라이브 바이다운로드 기술의 페이로드(payload)와 같은 방법을 통해 호스트 시스템에 전달됩니다.
* Cryptojacking Malware 주입 단계
  1. 스크립트 준비 단계는 승인되지 않은 암호화폐 채굴 악성코드 생성
  2. 공격자는 피해자를 속이기 위해 이 멀웨어를 합법적인 애플리케이션과 병합합니다.
  3. 악성코드 준비 후 악성 애플리케이션을 온라인 데이터 공유 플랫폼(예: 토렌트, 퍼블릭 클라우드)에 업로드하는 것으로 악성코드 주입 프로세스가 시작됩니다.
  4. 피해자가 감염된 애플리케이션을 다운로드하여 호스트 시스템(예: 개인용 컴퓨터, IoT 장치, 서버)에 설치하면 수명 주기의 맬웨어 주입 단계가 완료됩니다.
* Cryptojacking Malware 공격 단계
  1. 호스트 기반 크립토재킹 악성코드는 웹 소켓 또는 API를 통해 마이닝 풀에 연결되고 해시 퍼즐 작업을 수신하여 해시 값을 계산합니다
  2. 계산된 해시 값은 마이닝 풀로 다시 전송됩니다.
  3. 마지막으로 공격자는 에너지 소비 없이 피해자와 아무 것도 공유하지 않고 모든 수익을 받습니다.
* 서비스 제공자로부터 모든 수익을 암호화폐 형태로 받은 공격자는 수익을 사용할 수 있는 세 가지 옵션이 있습니다. 
  1. 교환 또는 p2p 거래를 통해 법정 통화로 변환
  2. 서비스를 위한 암호화폐로 사용 [50] , 또는 
  3. 암호화폐 믹싱 서비스를 사용하여 그 흔적을 덮습니다. 
* 크립토재킹 경제/지불에 대한 추가 종단 간 분석은 이 연구의 범위를 벗어나며 랜섬웨어 도메인에서 유사한 연구를 찾을 수 있습니다.

# Cryptojacking Malware Techniques
이 섹션에서는 크립토재킹 멀웨어가 사용하는 기술에 대해 설명합니다. 특히, 우리는 다음 사항을 분명히 합니다.
- 크립토재킹 멀웨어의 출처
- 감염 방법
- 피해자 플랫폼 유형
- 대상 암호화폐
- 회피 및 난독화 기술

## Source of Cryptojacking Malware
이 하위 섹션에서는 스크립트가 누구에 의해 생성되고 공격자에게 어떻게 배포되는지 설명합니다.

### Service Providers
* Service Provider는 cryptojacking scripts 들을 만들고 분배한다.
* Service Provider는 모든 유저에게 독립된 ID를 부여한다. (hash power면에서 그들을 구분하기 위해서)
* Service Provider는 사용자를 위해서 script를 생성해준다. (사용자가 악의적인지 아닌지에 상관없이)
* 행위를 할 필요가 있는 모든 유저들은 (공격을 위한 malicious sample을 만들기 위해서) script를 복사하고 붙여넣는다. 
* Coinhive는 2017년에 브라우저에서 mining script를 즉시사용하게 될수 있도록 제안한 첫번째 service provider이다. (web site와 content owner에게 대체 소득을 주기 만들어주기 위해서)
* ```비록 Coinhive의 첫번째 아이디어는 webpage onwer에게 대체가능한 소득을 주는 것이었을 지라도, 이것은 빠르게 공격자들사이에게 유명해졌다.```
* Conhive의 활동 동안, 그들(공격자들)은 Monenro의 전체 해쉬 비율의 상당한 몫을 점유했다.
* Monero's price가 급격하게 하락 후, Coinhive는 그들의 Owner들에 의해서 2019년 3월에 shutdown 되었다. (더이상 상업적으로 이득을 볼 수 없기 때문에)
* 그들의 연산(활동)을 지속하기 위한 몇몇 대채 service provider들은 Authedmine [3], Browsermine [58], Coinhave [59], Coinimp [60], Coinnebula [61], Cryptoloot [4], DeepMiner [62], JSECoin[63], Monerise [64], Nerohut [65], Webmine [66], WebminerPool[67], and Webminepool [68]. 이다.
* 몇몇의 이런 service provider들은 또한 몇몇 새로운 기능들을 가져왔다. (사용자가 크립토마이닝 매개변수를 조정할 수 있도록 사용자 알림 방법 또는 GUI를 제공하는 것과 같은 것.)
* ```주목해라, 우리는 또한 이런 service provicer들이 PublicWWW데이터 세트의 샘플을 사용하는 것을 확인했다.```
* 각각의 sample의 따르는 service provider들을 찾기위해서, 우리는 모든 샘플의 HTML source code에서 keytword 검색을 수행했다.

* 우리는 5328개의 샘플이 앞서 언급한 14개의 서비스 제공자 중 하나를 사용하는 반면 941개의 샘플은 알려지지 않은 서비스 제공자를 사용한다는 것을 발견했습니다. 
* 또한 144개의 샘플이 소스 코드에 여러 서비스 제공업체의 스크립트를 사용하고 있다는 사실도 확인했습니다. 

* PublicWWW 데이터셋에 대한 자세한 내용은 부록에서 확인할 수 있습니다.
  * VT 데이터 세트에는 AV 탐지 방법을 우회할 수 있는 샘플과 VT에 제출한 적이 없는 샘플이 포함되지 않습니다. 
  * 보다 포괄적이고 최신의 크립토재킹 악성코드 데이터 세트를 생성하기 위해 HTML 소스 키워드 검색 엔진인 PublicWWW[45]를 사용했습니다. 
  * 다음 단계를 사용하여 PublicWWW 데이터 세트를 만들었습니다.
    1) 블랙리스트 [106], [107], 이전 연구 [74], [112]에서 키워드 목록을 얻었고 VT 데이터 세트에서 샘플의 수동 분석을 얻었습니다. 특히, 우리는 NoCoin[106]과 MinerBlock[107]의 병합된 블랙리스트를 사용했습니다. [74]의 76개 키워드와 [112]의 38개 키워드; VirusTotal 샘플의 25개 키워드.
    2) PublicWWW에서 각 키워드에 대한 URL 목록을 다운로드했습니다.
    3) 고유한 URL 목록을 얻기 위해 목록을 병합하고 중복을 제거했습니다. 
    4) 웹 크롤러를 사용하여 각 URL의 HTML 소스 코드를 다운로드했습니다.  
    5) 샘플의 소스 코드에서 키워드를 확인하여 샘플을 확인하고 이 조건을 만족하지 않는 샘플을 제거했습니다.
  * 이 프로세스를 통해 6269개의 고유한 URL이 생성되었습니다.
  * 소스 코드 및 이 샘플에 사용된 154개의 고유 키워드가 포함된 최종 키워드 목록입니다. 
  * 이전 두 연구[74], [112]와 공개적으로 알려진 서비스 제공자에 대한 연구 결과에서 우리는 총 14개의 서비스 제공자를 식별했습니다.
  * 설명서를 수동으로 분석한 결과 5328개의 샘플이 해당 14개 서비스 제공업체의 스크립트를 사용하고 있음을 발견했습니다.
  * 그런 다음 샘플을 고유하게 캡처하기 위해 24개의 고유한 키워드를 식별했습니다. 
  
  ![image](https://user-images.githubusercontent.com/67637935/144188848-0fcf6575-8745-4aea-abab-87c1e04688fc.png)
  
  * 그림 9는 PublicWWW 데이터 세트에 있는 샘플의 서비스 제공자 분포를 보여줍니다. 
  * 그림과 같이 비활성 상태임에도 불구하고 코인하이브는 여전히 가장 보편적인 서비스 제공자입니다. 
  * 반면, Coinimp는 두 번째로 높은 서비스 제공업체이며 이 문서를 작성하는 현재에도 여전히 활성화되어 있습니다.
  * 또한 144개의 샘플이 여러 샘플의 스크립트를 사용하고 있는 반면 941개의 샘플 중 관련 서비스 공급자를 식별할 수 없음을 발견했습니다. 
  * 또한 PublicWWW에 있는 샘플은 이 백서의 실험 중에 캡처되었지만 이러한 도메인에 미래에 언제든지 암호 화폐 마이닝 스크립트가 포함될 것이라는 의미는 아닙니다. 
  * 따라서 소스 코드를 확인하여 분석을 위해 암호 화폐 마이닝 스크립트의 존재를 다시 확인해야 할 수 있습니다.

### Cryptominer S/W
* 블록체인 네트워크는 여러 네트워크 프로토콜과 암호화 인증 방법에 의존합니다.
* miner는 이러한 프로토콜의 일부여야 하며 커뮤니티에서 제공하고 개발한 규칙을 따라야 합니다. 
* PoW 기반 암호화폐에는 블록체인 네트워크에 대한 특정 규칙도 있습니다. 
* 블록체인 기술의 공개적이고 개방적인 특성으로 인해 이러한 miner의 소스 코드는 코드 공유 및 공동 개발 플랫폼을 통해 커뮤니티에서 게시됩니다. 
* 공격자는 이러한 miner를 쉽게 획득 및 수정하고 피해자의 호스트 시스템 내에서 광업을 수행하도록 채택할 수 있습니다. 
* 또한 여러 마이닝 풀에서 제공하는 몇 가지 플러그 앤 플레이 스타일 마이닝 응용 프로그램도 있습니다. 
* 공격자들은 또한 크립토재킹을 위해 이러한 애플리케이션을 수정하고 있습니다. 
* 예를 들어, XMRig[69]는 합법적인 고성능 Monero 광부 구현이며 오픈 소스입니다. 
* 그 서명은 Palo Alto Networks와 IBM에 의해 보고된 전 세계 수백만 대의 최종 장치에 영향을 미치는 몇 가지 매우 영향력 있는 공격에서 발견됩니다[70, 71]. 
* 또한 VT 데이터 세트에서 "xmrig"라는 서명으로 레이블이 지정된 139개의 고유한 샘플도 발견했습니다.

## Infection Methods
이 섹션에서는 크립토재킹 악성코드가 사용하는 감염 방법에 대해 자세히 설명합니다.

### Websites Owner
웹사이트 서버에 대한 관리자 액세스 권한이 있는 웹사이트 소유자는 브라우저 내 마이닝 스크립트를 사용하여 추가 수익을 얻거나 제공하는 프리미엄 콘텐츠에 대한 대체 옵션을 제공할 수 있습니다. 이 방법으로만 웹 페이지 소유자는 웹 페이지에서 스크립트의 수익을 받을 수 있습니다. 일부 웹사이트 소유자는 방문자에게 자신이 사용하는 크립토마이닝 스크립트에 대해 알리지만 다른 웹사이트 소유자는 방문자에게 알리지 않으며 이러한 행동은 여러 국가에서 범죄로 간주될 수 있습니다[72].

### Compromised Websites
* 공격자는 여러 취약점이 있는 임의의 웹 페이지에 크립토재킹 멀웨어를 주입할 수 있습니다. 실제로 크립토재킹이라는 이름 자체는 "크립토마이닝"과 "하이재킹"의 조합입니다. Ruth et al. [73] 10명의 다른 사용자가 찾은 모든 Coinhive 스크립트의 85%를 생성했다고 말합니다. 이 웹페이지의 소유자는 이 스크립트에 대한 정보가 없습니다. 또한, 그들은 그들로부터 이익을 얻지 못합니다.
* 몇몇 연구에서는 공격자가 일반적으로 감염된 모든 웹 페이지에 대해 동일한 ID를 사용하여 보다 쉽게 추적할 수 있다고 주장합니다. 예를 들어, [74]의 저자는 이 방법을 통해 크립토재킹 캠페인을 공개하고 이러한 캠페인의 대부분이 원격 코드 실행 취약점과 같은 취약점을 활용한다는 것을 발견했습니다. 이 도메인과 관련된 일반적인 사례를 조사했을 때 한 보안 회사는 모든 ap.gov.in 도메인 및 하위 도메인에 영향을 미치는 인도 정부 웹 페이지[75] 내에서 크립토재킹 멀웨어를 발견했습니다.

### Malicous Ads
일부 공격자는 자신의 크립토재킹 멀웨어를 JavaScript 기반 광고에 삽입하고 마이닝 스크립트를 통해 배포합니다. 이 방법을 사용하면 공격자가 추가 노력 없이 임의의 사용자에게 접근할 수 있습니다. 이 공격을 하기 위해 웹페이지나 애플리케이션을 감염시킬 필요가 없습니다. YouTube[5] 및 Google ad[76] 서비스도 감염되었으며 이러한 웹사이트와 해당 서비스의 사용자는 크립토재킹 공격의 피해자가 되었습니다. 공격자는 방문자와 함께 Monero를 성공적으로 채굴했습니다. 공격자는 방문자와 함께 Monero를 성공적으로 채굴했습니다. 이 방법의 장점은 공격자가 웹사이트의 서버에 액세스하지 않고 인기 있는 웹사이트에 삽입될 때 많은 방문자에게 도달할 수 있다는 것입니다.

### Malicious Browser Extensions
브라우저 확장은 또한 컴퓨터의 CPU 소스에 도달하여 웹 페이지에 있는 크립토재킹 맬웨어처럼 작동할 수 있습니다. 이것들
확장에는 큰 차이점이 있습니다. 감염된 브라우저가 피해자가 액세스한 웹 사이트와 독립적으로 열려 있는 한 온라인 상태를 유지하고 마이닝을 수행할 수 있습니다. 그러나 Google과 같은 주요 브라우저 운영자는 실제로 대부분 악용되고 있기 때문에 의도와 상관없이 플랫폼에서 모든 크립토마이닝 확장을 금지할 것이라고 발표했습니다[77].

### Third-party S/W
* 맬웨어를 시장 애플리케이션과 병합하고 여러 공유 플랫폼을 통해 게시하는 것은 맬웨어를 유포하는 공격자 사이에서 잘 알려진 방법입니다. 공격자는 크립토마이너 소프트웨어를 수정하여 백그라운드에서 크립토재킹을 실행하고 합법적인 애플리케이션과 병합합니다. 공격자는 계산 집약적인 응용 프로그램(예: 애니메이션 응용 프로그램, 하드웨어 요구 사항이 높은 게임, 엔지니어링 프로그램)을 사용하는 경향이 있습니다. 그 이유는 이러한 응용 프로그램을 사용하면 피해자의 시스템에 계산적으로 강력한 하드웨어와 호스트 기반 크립토재킹 멀웨어가 내장된 응용 프로그램이 있기 때문입니다. 피해자 호스트 시스템의 필요한 하드웨어 구성 요소에 대한 액세스 권한이 있어야 합니다.
* 한 공격자가 Zoom 화상 통화 애플리케이션을 일반 비트코인 광부와 병합하고 여러 공유 플랫폼을 통해 배포하는 등 서버의 주요 사례가 이미 발생했습니다. 또 다른 공격에서 공격자는 인기 있는 비디오 게임 Fortnite를 사용하여 Bitcoin을 채굴하기 위해 바이러스를 퍼뜨렸습니다. 2017년에 인기를 끌었던 브라우저 내 채굴과 달리 2013년에도 이 방법을 사용한 공격 사례를 발견했는데, 비트코인 채굴 스크립트가 게임 코드 자체의 일부로 발견되었습니다.

### Exploited Vulnerabilities.
여러 경우에 공격자는 하드웨어 및 소프트웨어에서 발견한 몇 가지 제로 데이 취약점을 악용합니다. 공격자는 채굴 악성코드를 여러 장치에 주입하여 암호화폐를 채굴하도록 합니다. 지난 몇 년 동안 몇 가지 중요한 사건이 발생했습니다. 가장 주목할 만한 예는 전 세계적으로 140만 Mikrotik [15] 라우터에 직접적인 영향을 미치며 하드웨어 운영 체제의 취약점이 이 사례를 유발합니다. 연구원들은 RCE(Remote Code Execution) 공격[80]의 대부분이 호스트 시스템 내에서 마이닝 스크립트를 찾는 것을 목표로 한다고 주장합니다.

### Social Engineering
사회 공학은 맬웨어 공격자가 보안 관행을 우회하기 위해 일반적으로 사용하는 기술입니다. 마찬가지로 공격자는 사회 공학 공격을 사용하여 인간의 심리를 조작하고 피해자의 액세스 권한을 탐색하거나 컴퓨터에 악성 소프트웨어를 설치합니다. 연구원들은 공격자가 피해자의 컴퓨터에 크립토재킹 멀웨어를 설치하기 위해 사회 공학과 같은 오래된 기술을 여전히 사용하고 있음을 관찰했습니다.

### Drive-by Download
드라이브 바이 다운로드는 악성 파일 공격자가 자신도 모르게 피해자의 기기에 악성 파일을 전달하고 설치하는 데 사용하는 또 다른 기술입니다. 피해자는 웹 페이지를 방문하거나 팝업 창을 열거나 이메일 첨부 파일을 확인하는 동안 이 공격에 직면할 수 있습니다. 한 사례[49]에서 공격자는 이 방법을 사용하여 피해자의 기기에 크립토재킹 멀웨어를 삽입했습니다. 그들은 셸 실행 취약점을 악용하여 크립토재킹 멀웨어를 피해자의 컴퓨터에 직접 다운로드했습니다.
