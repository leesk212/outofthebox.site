---
tags: malware cryptojacking 🌟paper-review
toc: True
---
# Introduction

## Crpytojacking 동향
* 암호화폐 시장이 커지면서 암호화폐와 관련된 보안 위협이 증가하고 있습니다.
* 특히 Coinhive 또는 Monero에 의해서 즉시 사용가능한 (ready-to-use) 채굴 script를 통해서 cryptojacking malware는 공격자들을 위한 없어서 안될 도구가 되었다.
* 실제로 bank, military servers, online-video sharing platforms, gaming platform등은 cryptojacking malware의 가장 큰 피해자중 하나이다.
* 현재까지 이들을 방어하기 위해서, 1. blacklist방법으로부터 사용자를 방어하는 browser exetensiun 과 다른 분석 방식의 백신 프로그램은 단지 부분적인 "만병통치약"일뿐 공격자들은 난독화기술을 사용하여 쉽게 우회하거나 또는 그들의 도메인의 script를 바꿔서 공격을 진행한다.
* 그래서 추가적인 systematic인 cryptojacking연구가 필요하다.
* 투자자는 또한 직접 채굴 풀을 구축하여 새로운 코인을 생성하여 이익을 얻을 수 있다.
* 채굴 작업의 수익성은 공격자들이 빠르게 출현하는 생태계로 끌어들였다.

## Cryptojacking의 정의
* Cryptojacking은 암호화폐 채굴 동의 없이 피해자의 연산 능력을 이용하는 행위이다.
* 비권한된 mining 연산은 추가적인 전력 소비를 지불하게 하고, victim host 컴퓨터의 연산 효율을 매우 감소시킨다.
* 결과적으로 공격자는 비권한된 컴퓨터 파워를 cryptocurrency(암호화폐)로 변환시킨다.
* 이런 목적으로 사용된 mlaware를 *cryptojacking*이라 부른다.
* 특히 즉시 사용가능한 browser mining script 구현의 제공하는 Coinhive, CryptoLoot같은 service provider의 출현 이후에, 공격자들은 쉽게 인기있는 website를 통해 많은 수의 사용자들에게 접근할 수 있었다.

### Crpytojacking의 첫번째 예시: In-browser cryptojacking
* Cryptojacking은 Youtue내에 Google의 advertisement packages와 병합된다.
* victim의 host에 의해서 compile된 감연된 광고 package는 victime이 관련된 페이지에 있는한 비권한된 채굴을 수행한다. 
* Youtuge와 비슷한 media content 제공업체들은 공격자들에게 이상적이다. (상대적 신뢰도, 인기도, 그리고 이용자들의 평균 이용시간 때문에)
* 또 다른 사건에서 cryptojacking malware는 UK 정부에 의해서 제공된 plugin에서 발견되었다.
* 이때, 이 플러그인은 수천의 governmental page와 비 govermental-page에서 사용되었다.

### Cryptojacking의 두번째 예시: Critical servers.
* cryptojacking의 web-page에 내장되어있는 것 뿐만아니라, 또한 *well-protected govermental and milittary servers*에서 발견된다.
* 미 방어 정부는 bug-bounty challenge 동안, 그들의 서버에서 cryptojacking malware를 발견했다.
* Cryptojacking malware는 Coinhive 제공업체에서 유명한 서비스에 의해서 개발된, 그리고 이것의 존재동안 35.4 Monero coin에서 채굴된 DOD server들에서 발견되었다. 
* 비슷하게, 다른 정부 캐이스는 러시아 핵 개발 연구 센터로부터 발견되었다.
* 몇몇 이 연구실에서 일하고 있는 과학자들은 이 시설 server에서 암호화폐 채굴기를 업로드해서 잡혔다.
* 더 나아가서 공격자는 서비스 제공자가 제공하는 스크립트를 사용할 뿐만 아니라 악의적이지 않고 합법적인 오픈소스 크립토마이너를 수정했다.
* 예를들어 cyber security 회사는 이탈리아 은행의 기업 네트워크에서 잘 알려진 유럽 기반 봇넷으로의 불규칙한 데이터 전송을 탐지했다. 추가 조사를 통해 해당의 것이 Bitcoin miner임을 확인했다.

### Cryptojacking의 세번째 예시: 진보된 기술을 이용하는 것
* Attacker가 cryptojacking을 퍼트리는데 사용하는 *advanced techniques*들이 있다.
  * botnet, Vollgar <- attacked all MySQL Servers in the world 
  * Zoom video <- merged the main Zoom application and cryptojacking malware and published it via different file-sharing platforms
  * Steam & Nintendo Switch <- to embed and distribute crpytojacking malware
  * (in a recent study) firmware(Mikrotik) <- discoverd a firmware exploit in Mikrotik routers that were used to embed crpytomining code into every outgoing web connection, where 1.4 million MikroTik routers were exploited

### Crpytojacking Detection의 문제점
* 크립토재킹 맬웨어의 만연한 특성을 감안할 때 무단 채굴 작업이 사용자의 동의나 허가 없이 컴퓨팅 플랫폼의 컴퓨팅 리소스를 남용하는 것을 감지하고 방지하는 것이 중요합니다.
* 그러나 중요하지만 크립토재킹을 탐지하는 것은 여러 면에서 기존 멀웨어와 다르기 때문에 어렵습니다.
  * 1. 첫번째 그들은 목표는 victim의 computing power를 남용하는 것이다. ( 전통적인 malware의 경우에서 피해를 입히거나 조작하는 것 대신에), 전통적인 malware detection과 방어 시스템은 malware의 침해 행위를 탐지하는 것에 최적화 되어있지만 cryptojacking은 단지 컴퓨팅 ㅈ자원을 사용하고 그리고 attacker에게 계산된 hash값을 전달한다. 그래서 malware detection sytstem은 단순히 높은 퍼포먼스를필요하는 무건운 어플리케이션으로써 생각한다.
  * 2. 둘째, 합법적인 웹 사이트에 사용하거나 포함할 수도 있습니다. 이는 해당 웹 사이트가 종종 신뢰할 수 있고 사용자가 컴퓨터에서 동의 없이 채굴하는 것을 기대하지 않기 때문에 눈에 띄기 어렵게 만듭니다.
  * 3. 셋째, 전통적인 맬웨어 공격에서 공격자는 궁극적으로 민감한 정보를 빼내거나(예: APT(Advanced Persistent Threat)) 시스템을 사용할 수 없도록 하거나(즉, DDoS(분산 서비스 거부)) 제어할 수 있습니다. 크립토재킹 맬웨어 공격에서 피해자의 컴퓨터(예: Botnet)에서 공격자의 목표는 가능한 한 오랫동안 시스템에서 은밀하게 유지하는 것입니다. 공격 수익은 크립토재킹 멀웨어가 탐지되지 않는 시간에 정비례하기 때문입니다. 따라서 공격자는 필터링 및 난독화 기술을 사용하여 멀웨어를 탐지 시스템에서 더 어렵게 만들고 사용자가 알아차리기 어렵게 만듭니다.

## 해당 논문의 Contribution
* 기존의 연구는 Cryptojacking malware에 대한 탐지 또는 방지 메커니즘을 제안하거나, 크립토재킹 위협 환경을 분석하고있다.
* 그리고 문헌에는 서로 다른 크립토재킹 맬웨어 유형, 크립토재킹 맬웨어가 사용하는 기술 및 문헌의 크립토재킹 연구에 대한 검토를 모두 다루는 체계적인 연구가 부족합니다.
* 이 논문은 이런 문헌의 차이를 줄이기위해서 cryptojacking malware의 systematic overview를 제시한다. (42개의 cryptojacking 연구 논문ㄷ르의 조합으로부터 얻을  수 있는 정보에 기반하여서) (두개의 독립적인 dataset과 함께 26K개의 cryptojacking samples 들과) (그리고 45개의 major attacks instance와 함께)
* 주어진 널리퍼진 cryptojacking의 사용에 의해서, 실무적인 방어 솔루션을 방어를 가속화하기 위해서 security community crpytojacking malware의 systematize한 지식을 얻는 것은 이것은 중요하다 

### 해당 논문에 포함되어있는 추가적인 견해
* 최근 보안 보고서에서는 클라우드 서버, Docker 엔진, 대규모 Kubernetes 클러스터의 IoT 장치와 같은 보다 강력한 플랫폼을 대상으로 하는 크립토재킹 공격의 수가 증가하는 것을 발견했습니다. 크립토재킹 악성코드를 퍼뜨리기 위해 하이재킹 및 초기 액세스 를 얻기 위해 공격자는 다음을 활용합니다.
  * hardware vulnerabilites
  * recent CVEs
  * poorly configured IoT devices
  * Docker engines and Kubernetes clusters with poor security
  * popular DDoS botnets for the sied-profit.
  * 이 새로운 크립토재킹 악성코드 경향은 연구원들이 자세히 조사하지 않았습니다.
* 우리는 문헌에서 크립토재킹 탐지 메커니즘을 제안하는 연구에서 몇 가지 문제를 확인했습니다.
  * 첫째, 우리는 크립토마이닝 스크립트가 포함된 웹사이트가 자주 업데이트되기 때문에 제안된 탐지 연구에서 데이터 세트 날짜를 보고하는 것이 중요하다는 것을 발견했습니다. 이는 문헌 연구에서 흔하지 않습니다.
  * 둘째, 제안된 탐지가 대부분의 연구에서 누락된 온라인 또는 오프라인인지 보고하는 것이 중요합니다.
  * 셋째, 문헌의 연구에서는 제안된 솔루션의 사용자 측 오버헤드를 측정하지 않았으며, 이는 특히 브라우저 기반 솔루션에서 매우 중요합니다.
* 크립토마이닝이 게시자나 비영리 조직과 같은 합법적인 웹사이트 소유자를 위한 대체 자금 조달 메커니즘이 될 수 있지만 브라우저 내 크립토마이닝의 사용은 키워드 기반 자동 감지 시스템으로 인해 감소했습니다.
* 다른 조사:
  * 이러한 설문조사는 블록체인의 합의 프로토콜 및 채굴 전략, Bitcoin 및 블록체인 기술의 도전, 보안 및 개인 정보 보호 문제, IoT와 같은 다양한 산업에서의 블록체인 구현에만 초점을 맞춥니다.
  * [A Survey of Attack Instances of Cryptojacking Targeting Cloud Infrastructure](https://dl.acm.org/doi/abs/10.1145/3379310.3379323) 과 비슷하지만 해당 SOK 논문은 (두 큰 dataset의 관찰과 분석으로 만들어진)cryptojacking malware에 더욱 집중되어있다. 

# Background

## BlockChain
블록체인은 네트워크의 당사자가 수행하는 P2P(피어 투 피어) 거래를 변경할 수 없는 방식으로 저장하는 분산형 디지털 원장 기술입니다. 블록체인 구조는 블록 체인으로 구성됩니다. 예를 들어 비트코인[39]에서 각 블록은 블록 헤더와 트랜잭션의 두 부분으로 구성됩니다. 블록 헤더는 1) 이전 블록의 해시, 2) 버전, 3) 타임스탬프, 4) 난이도 목표, 5) 논스, 6) 머클 트리의 루트 정보로 구성됩니다. 이전 블록의 해시를 포함함으로써 모든 블록은 수학적으로 이전 블록에 바인딩됩니다. 이 바인딩을 사용하면 체인의 모든 블록에서 데이터를 변경할 수 없습니다. 반면, 각 블록의 두 번째 부분에는 개별적으로 확인된 트랜잭션 집합이 포함됩니다.

## Cryptocurrency Mining
* 블록체인의 불변성은 합의 메커니즘에 의해서 제공되어진다. 그리고 이것은 "Proof-of-Work" protocol에 의해서 일반적으로 말해진다.
* 각각의 block의 불변성과 그리고 전체 블록체인의 불변성은 block 구조의 chain 덕분에 보존된다.
* PoW에서 network에서의 몇몇 노드는 unique한 hash value를 찾기위해서 hash puizzle을 해결한다. 그리고 이것을 네트워크에 있는 모두 다른 노드에게로 broadcasting을 진행한다.
* valid hash value를 broadcasting한 첫번째 노드는 block reward에게 보상을 받고 그리고 transaction fee를(거래 수수료를) 수집한다. 
* A valid hash value는 다른 타겟에 따라서 검증되어진다. (만약 이것이 다른 타겟을 만족된다면, 이것은 모든 다른 노드들이 승낙해야하고 그리고 타당한 hash에서 찾은 노드는 보상받아진다.
* 다른 PoW 구현은 대게 다른 타겟에의해서 다른 방법을 갖고 있습니다.

### Cryptomining(jacking)의 공격자의 공격 동기(?) 
* Miner는 시행착오를 통해 모든 시도에 대한 nonce값을 증가시켜 유효한 hash 값을 찾으려고 한다.
* 유효한 hash값이 찾아지자마자, 전체적인 block은 넹트워크에 broadcast되고, 해당 block은 가장 마지막 블록의 끝에 추가되어진다.
* 이것은 잘 알려진 *cryptocurrency mining*의 과정이다 그리고 이것은 새로운 cryptocurrencies를 만들기위한 단지 하나의 방법이다.
* miner들에 의해서 valid hash value의 찾는것의 기회는 직접적으로 minor의 hash power와 관련이다. (그리고 이것은 hardware 기반된 연산능력과 관련있다.)
* 그러나 더 많은 하드웨어는 전력 소비를 증가시킨다.
* 따라서 공격자는 자신의 전력 소비를 늘리지 않고 계산 능력을 높일 수 있는 새로운 방법을 찾고자 하는 동기를 갖게 됩니다.

### Mining의 역사
* Bitcoin의 발명에 따라서, 만은 다른 대체코인 (altcoin들은) 합병되거나 또는 여전히 합병중이다. 이러한 새로운 암호화폐는 비트코인의 일부 문제(예: 확장성[40], 개인 정보 보호)를 해결하거나 새로운 애플리케이션(예: 스마트 계약[41])을 제공한다고 주장합니다.
* Bitcoin의 일찍의 개발에서 mining은 주로 CPU에서 이뤄졌고 사용자들은 쉽게 귿르의 일반적인 CPU를 Bitcoin Mining에 사용할 수 있었다.
* 시간이 흘러서 GPU 기반의 miner들은 충분히 CPU miner보다 더 많은 이득을 얻을 수 있었다. GPU들이 특히 무거운 applicaiton을 위한 높은 연산능력을 가졌기 때문이다.
* 후에 Field Programmable Gate Array(FPGA)는 암호화폐 체굴의 경향을 바꿨다. 그들은 hardware를 customized하고 그리고 충분한 이익을 제공하기 때문이다. (CPU, GPU 기반의 체굴보다) 
* 마지막으로, Mining에 기반되는 Application-Specific Integrated Circuit (ASIC)의 사용은 최근에 채굴 산업을 지배하고 이;ㅆ다. 그들은 특히 암호화폐 체굴을 위해서 특히 제작되고 구성될 수 있기 떄문이다.

### Block-chain의 다양한 hash_function의 사용, Monero의 해쉬 함수 사용의 진행
* alternative cryptocurrencies들은 또한 block-chain에서 다른 hash function을 사용했다. 그리고 이것은 채굴 과정에서 다양성을 이끌었다.
 * Monero는 CryptoNight algorithm을 hash function으로 사용한다. CryptoNight는 특히 CPU와 GPU Mining을 위해서 디자인되었다. 이것은 ASIC miner들을 막기위해서 L3 Cache를 사용한다.
 * RandomX algorithm의 사용과 함께 Monero blockchain은 완전히 ASIC miner들이 줄어들게 하였고 그리고, CPU의 특성을 최대로 사용할 수 있게하였다.
 * 이 특징은 Monero가 단지 주요한 암호화폐 CPU 마이닝의 선호도를 증가시키면서 platform이 되도록했다. 
 * 또한, 모네로는 사설 암호화폐로도 알려져 있으며, 믹서와 링 서명을 통해 추적 불가능 및 연결 불가능 기능을 제공합니다.
 * Monero의 ASIC 채굴 방지 특성과 개인 정보 보호 기능은 공격자에게 바람직합니다.
